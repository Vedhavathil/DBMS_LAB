CREATE TABLE FLIGHTS(FLNO INTEGER PRIMARY KEY,FROMM VARCHAR(15) NOT NULL,TOO VARCHAR(15) NOT NULL,DISTANCE INTEGER,DEPARTS TIME,ARRIVES TIME,PRICE INTEGER);
INSERT INTO flights VALUES(101,'Bangalore','Delhi',2500,'07:15:31','17:15:31',5000);
INSERT INTO flights VALUES(102,'Bangalore','Lucknow',3000,'07:15:31','11:15:31',6000);
INSERT INTO flights VALUES(103,'Lucknow','Delhi',500,'12:15:31','17:15:31',3000);
INSERT INTO flights VALUES(107,'Bangalore','France',8000,'07:15:31','22:15:31',60000);
INSERT INTO flights VALUES(104,'Bangalore','France',8500,'07:15:31','23:15:31',75000);
INSERT INTO flights VALUES(105,'Kolkata','Delhi',3400,'07:15:31','09:15:31',7000);
SELECT *FROM FLIGHTS;
CREATE TABLE AIRCRAFT(AID INTEGER PRIMARY KEY,ANAME VARCHAR(10),CRUISINGRANGE INTEGER);
INSERT INTO aircraft VALUES(101,'indigo',3000);
INSERT INTO aircraft VALUES(102,'Boeing',900);
INSERT INTO aircraft VALUES(103,'hal',800);
INSERT INTO aircraft VALUES(104,'Dreamliner',10000);
INSERT INTO aircraft VALUES(105,'Boeing',3500);
INSERT INTO aircraft VALUES(106,'tejas',1500);
INSERT INTO aircraft VALUES(107,'Dream', 120000);
SELECT *FROM AIRCRAFT;
CREATE TABLE EMPLOYEES(EID INTEGER PRIMARY KEY,ENAME VARCHAR(15),SALARY_NUMBER INTEGER);
INSERT INTO employees VALUES(701,'A',50000);
INSERT INTO employees VALUES(702,'B',100000);
INSERT INTO employees VALUES(703,'C',150000);
INSERT INTO employees VALUES(704,'D',90000);
INSERT INTO employees VALUES(705,'E',40000);
INSERT INTO employees VALUES(706,'F',60000);
INSERT INTO employees VALUES(707,'G',90000); 
SELECT *FROM EMPLOYEES;
CREATE TABLE CERTIFIED(EID INTEGER NOT NULL,AID INTEGER NOT NULL,PRIMARY KEY (EID, AID),FOREIGN KEY (EID) REFERENCES EMPLOYEES (EID),FOREIGN KEY (AID) REFERENCES AIRCRAFT (AID));
INSERT INTO certified VALUES(701,101);
INSERT INTO certified VALUES(701,102);
INSERT INTO certified VALUES(701,106);
INSERT INTO certified VALUES(701,105);
INSERT INTO certified VALUES(702,104);
INSERT INTO certified VALUES(703,104);
INSERT INTO certified VALUES(704,104);
INSERT INTO certified VALUES(702,107);
INSERT INTO certified VALUES(703,107);
INSERT INTO certified VALUES(704,107);
INSERT INTO certified VALUES(702,101);
INSERT INTO certified VALUES(703,105);
INSERT INTO certified VALUES(704,105);
INSERT INTO certified VALUES(705,103);
SELECT *FROM certified;
SELECT DISTINCT a.aname FROM aircraft a,certified c,employees e WHERE a.aid=c.aid AND c.eid=e.eid AND NOT EXISTS(SELECT *FROM employees e1 WHERE e1.EID=e.EID AND 'e1.salary<80000');
SELECT c.eid,MAX(cruisingrange)FROM certified c,aircraft a WHERE c.aid=a.aid GROUP BY c.eid HAVING COUNT(*)>3;
SELECT DISTINCT E.ename FROM Employees E WHERE E.SALARY_NUMBER<(SELECT MIN(F.price)FROM Flights F WHERE F.fromm='Bangalore' AND F.too='France');
SELECT a.aname,AVG(e.SALARY_NUMBER)FROM aircraft a,certified c,employees e WHERE a.aid=c.aid AND c.eid=e.eid AND a.cruisingrange>1000 GROUP BY a.aid,a.aname;
SELECT DISTINCT E.ename FROM Employees E, Certified C, Aircraft A WHERE E.eid = C.eid AND C.aid = A.aid AND A.aname LIKE 'Boeing%'; 
SELECT A.aid FROM Aircraft A WHERE A.cruisingrange>(SELECT MIN(F.distance)FROM Flights F WHERE F.fromm='Bangalore' AND F.too='France');
SELECT F.departs FROM Flights F WHERE F.flno IN((SELECT F0.flno FROM Flights F0 WHERE F0.fromm ='Bangalore' AND F0.too ='Delhi'AND EXTRACT(HOUR FROM F0.arrives)<18)OR(SELECT F0.flno FROM Flights F0, Flights F1 WHERE F0.fromm='Bangalore' AND F0.too<>'Delhi' AND F0.too=F1.fromm AND F1.too='Delhi'AND F1.departs>F0.arrives AND EXTRACT(HOUR FROM F1.arrives)<18)NOT IN
(SELECT F0.FLNO FROM Flights F0,Flights F1,Flights F2 WHERE F0.fromm='Bangalore' AND F0.too=F1.fromm AND F1.too=F2.fromm AND F2.too='Delhi'AND F0.too<>'Delhi' AND F1.too<>'Delhi' AND F1.departs>F0.arrives AND F2.departs>F1.arrives AND EXTRACT(HOUR FROM F2.arrives)<18));
SELECT E.ename, E.SALARY_NUMBER FROM Employees E WHERE E.eid NOT IN(SELECT DISTINCT C.eid FROM Certified C)AND E.SALARY_NUMBER>(SELECT AVG (E1.SALARY_NUMBER)FROM Employees E1 WHERE E1.eid IN(SELECT DISTINCT C1.eid FROM Certified C1 ) ); 
